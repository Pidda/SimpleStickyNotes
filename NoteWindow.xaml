<Window x:Class="SimpleStickyNotes.NoteWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent"
        ResizeMode="CanResizeWithGrip"
        Topmost="True"
        Width="250"
        MouseDown="Window_MouseDown"
        MouseDoubleClick="Window_MouseDoubleClick"
        WindowState="Normal"
        StateChanged="Window_StateChanged"
        ShowInTaskbar="False">

    <Border CornerRadius="10"
            BorderThickness="1"
            BorderBrush="#FFB000"
            Background="#FFFFF4A3">

        <DockPanel>

            <!-- HEADER BAR (always visible) -->
            <Grid Height="28" Margin="5,0,5,0" DockPanel.Dock="Top" Background="#FFFFF4A3">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>   
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- DISPLAY TITLE -->

                <TextBlock x:Name="TitleText"
                           Text="{Binding Title}"
                           VerticalAlignment="Center"
                           Margin="8,0"
                           FontWeight="Bold"
                           MouseLeftButtonDown="TitleText_PreviewMouseLeftButtonDown"/>

                <!-- EDIT TITLE -->
                <TextBox x:Name="TitleEditor"
                         Text="{Binding Title, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                         Visibility="Collapsed"
                         VerticalAlignment="Center"
                         Margin="6,0"
                         FontWeight="Bold"
                         BorderThickness="0"
                         Background="Transparent"
                         LostFocus="TitleEditor_LostFocus"
                         KeyDown="TitleEditor_KeyDown"/>

                <!-- COLLAPSE -->
                <Button x:Name="CollapseButton"
                        Grid.Column="1"
                        Content="▁"
                        Width="22"
                        Height="22"
                        Margin="2"
                        Click="Collapse_Click"/>


                <!-- CLOSE -->
                <Button Grid.Column="2" Content="🗑"
                        Width="22"
                        Height="22"
                        Margin="2"
                        Click="Delete_Click"
                        ToolTip="Delete note"/>
                <Button Grid.Column="3"
                        Content="X"
                        Width="22"
                        Height="22"
                        Margin="2"
                        Click="Close_Click"
                        ToolTip="Close note"/>
            </Grid>

            <Grid x:Name="ContentPanel">
                <ScrollViewer VerticalScrollBarVisibility="Auto"
                              HorizontalScrollBarVisibility="Disabled"
                              Padding="0">

                    <!-- DISPLAY MODE -->
                    <ItemsControl x:Name="ItemsList"
                          MouseDoubleClick="Window_MouseDoubleClick">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <StackPanel Orientation="Horizontal"
                                            Margin="2"
                                            Height="18">

                                    <CheckBox IsChecked="{Binding IsChecked, Mode=TwoWay}"
                                              Checked="CheckboxChanged"
                                              Unchecked="CheckboxChanged"
                                              Height="18"
                                              MinHeight="18"
                                              Margin="5,3,0,0"
                                              Padding="0"
                                              VerticalAlignment="Top"/>

                                    <TextBlock Text="{Binding Text}"
                                               Margin="4,0,0,0"
                                               Padding="0"
                                               FontSize="14"
                                               LineHeight="18"
                                               VerticalAlignment="Top"/>
                                </StackPanel>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>

                </ScrollViewer>
                <!-- EDIT MODE -->
                <TextBox x:Name="EditBox"
                     AcceptsReturn="True"
                     TextWrapping="Wrap"
                     Visibility="Collapsed"
                     LostFocus="EditBox_LostFocus"
                     KeyDown="EditBox_KeyDown"
                     VerticalScrollBarVisibility="Auto"/>
            </Grid>
        </DockPanel>

    </Border>
</Window>